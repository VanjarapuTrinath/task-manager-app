<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productivity Task Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-dark': '#1e293b',
                        'secondary-dark': '#334155',
                        'accent-blue': '#3b82f6',
                        'accent-green': '#10b981',
                    }
                }
            }
        }
    </script>
    <style>
        .task-item {
            transition: all 0.3s ease;
        }
        .task-list::-webkit-scrollbar {
            width: 6px;
        }
        .task-list::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.5); 
            border-radius: 3px;
        }
        .task-list::-webkit-scrollbar-track {
            background: transparent;
        }
    </style>
</head>
<body class="bg-gray-900 font-sans text-white min-h-screen p-4 md:p-8">

    <div id="app-container" class="max-w-4xl mx-auto">
        <h1 class="text-4xl font-extrabold mb-8 text-center text-accent-blue tracking-tight">
            Goal Tracker
        </h1>

        <div id="progress-container" class="bg-secondary-dark p-6 rounded-xl shadow-2xl mb-8">
            <div class="flex justify-between items-center mb-3">
                <h2 class="text-xl font-semibold">Overall Progress</h2>
                <span id="progress-percent" class="text-2xl font-bold text-accent-green">0%</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-3">
                <div id="progress-bar" class="bg-accent-green h-3 rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>
            <p id="reset-info" class="text-xs text-gray-400 mt-3 text-center"></p>
        </div>

        <form id="task-form" class="bg-secondary-dark p-6 rounded-xl shadow-2xl mb-8 flex flex-col md:flex-row gap-4">
            <input
                type="text"
                id="new-task-input"
                placeholder="Enter a new task..."
                class="flex-grow p-3 rounded-lg bg-primary-dark border border-gray-600 focus:outline-none focus:ring-2 focus:ring-accent-blue text-white placeholder-gray-400"
                required
            />
            <div class="flex space-x-4">
                <select id="task-type-select" class="p-3 rounded-lg bg-primary-dark border border-gray-600 text-white focus:outline-none focus:ring-2 focus:ring-accent-blue cursor-pointer">
                    <option value="daily">Daily Task</option>
                    <option value="important">Important Task</option>
                </select>
                <button
                    type="submit"
                    class="p-3 bg-accent-blue hover:bg-blue-600 text-white font-semibold rounded-lg shadow-md transition duration-200"
                >
                    Add Task
                </button>
            </div>
        </form>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-primary-dark p-6 rounded-xl shadow-2xl">
                <h2 class="text-2xl font-bold mb-4 text-center text-yellow-400">Daily Tasks (Resets Daily)</h2>
                <ul id="daily-tasks-list" class="space-y-3 task-list max-h-[400px] overflow-y-auto pr-2">
                </ul>
                <p id="daily-empty-message" class="text-center text-gray-500 mt-4 hidden">No daily tasks yet! Add one above.</p>
            </div>

            <div class="bg-primary-dark p-6 rounded-xl shadow-2xl">
                <h2 class="text-2xl font-bold mb-4 text-center text-red-400">Important Tasks (One-Time)</h2>
                <ul id="important-tasks-list" class="space-y-3 task-list max-h-[400px] overflow-y-auto pr-2">
                </ul>
                <p id="important-empty-message" class="text-center text-gray-500 mt-4 hidden">No important tasks yet! Add one above.</p>
            </div>
        </div>

        <div id="custom-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-secondary-dark p-6 rounded-xl w-full max-w-sm shadow-2xl">
                <h3 id="modal-title" class="text-xl font-bold mb-4">Edit Task</h3>
                <input type="text" id="modal-input" class="w-full p-3 rounded-lg bg-primary-dark border border-gray-600 focus:outline-none focus:ring-2 focus:ring-accent-blue text-white mb-4" />
                <div class="flex justify-end space-x-3">
                    <button id="modal-cancel-btn" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-white font-semibold transition duration-200">Cancel</button>
                    <button id="modal-confirm-btn" class="px-4 py-2 bg-accent-blue hover:bg-blue-600 rounded-lg text-white font-semibold transition duration-200">Save</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        const DAILY_TASKS_KEY = 'taskManagerDailyTasks';
        const IMPORTANT_TASKS_KEY = 'taskManagerImportantTasks';
        const LAST_RESET_DATE_KEY = 'taskManagerLastResetDate';

        let dailyTasks = [];
        let importantTasks = [];

        const dailyList = document.getElementById('daily-tasks-list');
        const importantList = document.getElementById('important-tasks-list');
        const dailyEmptyMsg = document.getElementById('daily-empty-message');
        const importantEmptyMsg = document.getElementById('important-empty-message');
        const taskForm = document.getElementById('task-form');
        const taskInput = document.getElementById('new-task-input');
        const taskTypeSelect = document.getElementById('task-type-select');
        const progressBar = document.getElementById('progress-bar');
        const progressPercent = document.getElementById('progress-percent');
        const resetInfo = document.getElementById('reset-info');

        const modal = document.getElementById('custom-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalInput = document.getElementById('modal-input');
        const modalConfirmBtn = document.getElementById('modal-confirm-btn');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');

        function getCurrentDateString() {
            return new Date().toISOString().slice(0, 10);
        }

        function loadTasks() {
            const storedDaily = localStorage.getItem(DAILY_TASKS_KEY);
            const storedImportant = localStorage.getItem(IMPORTANT_TASKS_KEY);
            dailyTasks = storedDaily ? JSON.parse(storedDaily) : [];
            importantTasks = storedImportant ? JSON.parse(storedImportant) : [];
        }

        function saveTasks() {
            localStorage.setItem(DAILY_TASKS_KEY, JSON.stringify(dailyTasks));
            localStorage.setItem(IMPORTANT_TASKS_KEY, JSON.stringify(importantTasks));
            calculateProgress();
        }

        function checkAndResetDailyTasks() {
            const today = getCurrentDateString();
            const lastResetDate = localStorage.getItem(LAST_RESET_DATE_KEY);

            if (lastResetDate !== today) {
                dailyTasks = dailyTasks.map(task => ({
                    ...task,
                    completed: false
                }));
                localStorage.setItem(LAST_RESET_DATE_KEY, today);
                resetInfo.textContent = `Daily tasks reset for ${today}. Start fresh!`;
                saveTasks();
                return true;
            } else {
                resetInfo.textContent = `Today is ${today}. Reset occurs at midnight.`;
                return false;
            }
        }

        function calculateProgress() {
            const allTasks = [...dailyTasks, ...importantTasks];
            const totalTasks = allTasks.length;

            if (totalTasks === 0) {
                progressBar.style.width = '0%';
                progressPercent.textContent = '0%';
                return;
            }

            const completedTasks = allTasks.filter(task => task.completed).length;
            const progress = Math.round((completedTasks / totalTasks) * 100);

            progressBar.style.width = `${progress}%`;
            progressPercent.textContent = `${progress}%`;
        }

        function renderTasks() {
            dailyList.innerHTML = '';
            importantList.innerHTML = '';

            dailyEmptyMsg.classList.toggle('hidden', dailyTasks.length > 0);
            importantEmptyMsg.classList.toggle('hidden', importantTasks.length > 0);

            dailyTasks.forEach(task => dailyList.appendChild(createTaskElement(task, 'daily')));
            importantTasks.forEach(task => importantList.appendChild(createTaskElement(task, 'important')));

            calculateProgress();
        }

        function createTaskElement(task, type) {
            const li = document.createElement('li');
            li.id = `${type}-${task.id}`;
            li.className = `task-item flex items-center p-4 rounded-lg shadow-md ${task.completed ? 'bg-gray-700/50 line-through text-gray-400' : 'bg-secondary-dark hover:bg-gray-700'} transition-all duration-300`;

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.checked = task.completed;
            checkbox.className = 'w-5 h-5 text-accent-green bg-gray-800 border-gray-600 rounded focus:ring-accent-green mr-4 cursor-pointer flex-shrink-0';
            checkbox.onclick = () => toggleComplete(task.id, type);

            const textSpan = document.createElement('span');
            textSpan.className = 'flex-grow text-base md:text-lg truncate';
            textSpan.textContent = task.text;

            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'flex space-x-2 ml-4 flex-shrink-0';

            const editBtn = document.createElement('button');
            editBtn.className = 'text-gray-400 hover:text-yellow-400 p-1 rounded transition duration-150';
            editBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zm-1.88 5.76L5 14.885V17h2.115l6.044-6.044-2.115-2.114z"/></svg>`;
            editBtn.onclick = () => openEditModal(task.id, type, task.text);

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'text-gray-400 hover:text-red-500 p-1 rounded transition duration-150';
            deleteBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clip-rule="evenodd"/></svg>`;
            deleteBtn.onclick = () => deleteTask(task.id, type);

            buttonsDiv.appendChild(editBtn);
            buttonsDiv.appendChild(deleteBtn);

            li.appendChild(checkbox);
            li.appendChild(textSpan);
            li.appendChild(buttonsDiv);

            return li;
        }

        function addTask(e) {
            e.preventDefault();
            const text = taskInput.value.trim();
            const type = taskTypeSelect.value;

            if (text === '') return;

            const newTask = {
                id: Date.now(),
                text: text,
                completed: false,
                type: type
            };

            if (type === 'daily') {
                dailyTasks.unshift(newTask);
            } else {
                importantTasks.unshift(newTask);
            }

            saveTasks();
            renderTasks();
            taskInput.value = '';
        }

        function toggleComplete(id, type) {
            const list = type === 'daily' ? dailyTasks : importantTasks;
            const taskIndex = list.findIndex(t => t.id === id);

            if (taskIndex !== -1) {
                list[taskIndex].completed = !list[taskIndex].completed;
                if (list[taskIndex].completed) {
                    const completedTask = list.splice(taskIndex, 1)[0];
                    list.push(completedTask);
                } else {
                    const incompleteTask = list.splice(taskIndex, 1)[0];
                    list.unshift(incompleteTask);
                }
                saveTasks();
                renderTasks();
            }
        }

        function deleteTask(id, type) {
            if (type === 'daily') {
                dailyTasks = dailyTasks.filter(t => t.id !== id);
            } else {
                importantTasks = importantTasks.filter(t => t.id !== id);
            }
            saveTasks();
            renderTasks();
        }

        function openEditModal(id, type, currentText) {
            modalTitle.textContent = `Edit ${type === 'daily' ? 'Daily' : 'Important'} Task`;
            modalInput.value = currentText;
            modal.classList.remove('hidden');
            
            modalConfirmBtn.onclick = () => saveEditedTask(id, type);
            modalCancelBtn.onclick = () => modal.classList.add('hidden');
        }

        function saveEditedTask(id, type) {
            const newText = modalInput.value.trim();
            if (newText === '') return;

            const list = type === 'daily' ? dailyTasks : importantTasks;
            const task = list.find(t => t.id === id);

            if (task) {
                task.text = newText;
                saveTasks();
                renderTasks();
            }
            modal.classList.add('hidden');
        }

        function initApp() {
            loadTasks();

            checkAndResetDailyTasks();

            renderTasks();

            taskForm.addEventListener('submit', addTask);
        }

        window.onload = initApp;

    </script>
</body>
</html>
